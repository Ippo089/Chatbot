<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FilsafatBooks Chatbot</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #0f172a;
      color: #e2e8f0;
      margin: 0;
      padding: 0;
      height: 100vh;
    }
    header {
      background-color: #1e293b;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid #334155;
    }
    header h1 {
      font-size: 20px;
      color: #38bdf8;
      margin: 0;
    }
    .chatbox {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 370px;
      background-color: #1e293b;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      border: 1px solid #334155;
      z-index: 9999;
    }
    .messages {
      height: 420px;
      padding: 15px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .user, .bot {
      padding: 10px;
      border-radius: 10px;
      max-width: 90%;
      white-space: pre-line;
    }
    .user {
      align-self: flex-end;
      background-color: #38bdf8;
      color: #0f172a;
    }
    .bot {
      align-self: flex-start;
      background-color: #334155;
      color: #e2e8f0;
    }
    .input-area {
      display: flex;
      border-top: 1px solid #334155;
    }
    .input-area input {
      flex: 1;
      padding: 10px;
      border: none;
      outline: none;
      background-color: #0f172a;
      color: #e2e8f0;
    }
    .input-area button {
      background-color: #38bdf8;
      color: #0f172a;
      border: none;
      padding: 10px 15px;
      cursor: pointer;
      font-weight: bold;
    }
    .book-card {
      background-color: #475569;
      border-radius: 8px;
      padding: 8px;
      margin-top: 8px;
      display: flex;
      align-items: center;
      gap: 10px;
      justify-content: space-between;
    }
    .book-card img {
      width: 50px;
      height: 70px;
      border-radius: 4px;
      object-fit: cover;
      border: 1px solid #334155;
    }
    .book-info {
      font-size: 12px;
      line-height: 1.3;
      flex: 1;
    }
    .book-card button {
      background-color: #38bdf8;
      border: none;
      color: #0f172a;
      font-size: 12px;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <header>
    <h1>üìö FilsafatBooks</h1>
  </header>

  <div class="chatbox">
    <div class="messages" id="chat">
      <div class="bot">Halo! Selamat datang di FilsafatBooks üëã<br>Pilih kategori buku:<br>‚Ä¢ Filsafat Islam<br>‚Ä¢ Sejarah Pemikiran<br>‚Ä¢ Teologi<br>‚Ä¢ Etika Sosial</div>
    </div>
    <div class="input-area">
      <input type="text" id="userInput" placeholder="Ketik pesan...">
      <button onclick="sendMessage()">Kirim</button>
    </div>
  </div>

  <script>
    const chat = document.getElementById("chat");
    const cart = [];
    let totalHarga = 0;

    const books = {
      "filsafat islam": [
        {
          judul: "Tahafut al-Falasifah",
          penulis: "Al-Ghazali",
          harga: 120000,
          stok: 5,
          img: "https://upload.wikimedia.org/wikipedia/en/2/26/Tahafut_al-Falasifah_-_Cover.jpg"
        },
        {
          judul: "Al-Muqaddimah",
          penulis: "Ibnu Khaldun",
          harga: 135000,
          stok: 3,
          img: "https://upload.wikimedia.org/wikipedia/en/f/f2/Muqaddimah_English_cover.jpg"
        },
        {
          judul: "Fashl al-Maqal",
          penulis: "Ibnu Rushd",
          harga: 110000,
          stok: 7,
          img: "https://upload.wikimedia.org/wikipedia/en/b/b5/Fasl_al-Maqal_-_cover.jpg"
        }
      ]
    };

    function sendMessage() {
      const input = document.getElementById("userInput");
      const text = input.value.trim();
      if (text === "") return;
      addMessage("user", text);
      input.value = "";

      setTimeout(() => botReply(text.toLowerCase()), 600);
    }

    function addMessage(sender, text) {
      const msg = document.createElement("div");
      msg.classList.add(sender);
      msg.innerHTML = text;
      chat.appendChild(msg);
      chat.scrollTop = chat.scrollHeight;
    }

    function botReply(text) {
      if (text.includes("halo") || text.includes("hai")) {
        addMessage("bot", "Halo juga! Ingin lihat kategori buku filsafat Islam?");
      } 
      else if (text.includes("filsafat islam")) {
        addMessage("bot", "Berikut daftar buku filsafat Islam yang tersedia:");
        books["filsafat islam"].forEach(b => {
          const card = document.createElement("div");
          card.classList.add("book-card");
          card.innerHTML = `
            <img src="${b.img}" alt="${b.judul}">
            <div class="book-info">
              <b>${b.judul}</b><br>
              ${b.penulis}<br>
              üí∞ Rp${b.harga}<br>
              üì¶ Stok: ${b.stok} buku
            </div>
            <button onclick="orderBook('${b.judul}')">Pesan</button>
          `;
          chat.appendChild(card);
        });
        addMessage("bot", "Klik tombol 'Pesan' untuk menambah buku ke keranjang.");
        chat.scrollTop = chat.scrollHeight;
      }
      else if (text.includes("keranjang")) {
        showCart();
      }
      else if (text.includes("bayar") || text.includes("checkout")) {
        checkout();
      }
      else if (text.includes("transfer") || text.includes("bank")) {
        confirmPayment("Transfer Bank");
      }
      else if (text.includes("wallet") || text.includes("e-wallet") || text.includes("ewallet")) {
        confirmPayment("E-Wallet");
      }
      else if (text.includes("cod")) {
        confirmPayment("COD (Bayar di Tempat)");
      }
      else {
        addMessage("bot", "Saya tidak memahami itu. Ketik 'filsafat islam' untuk melihat daftar buku atau 'keranjang' untuk melihat pesanan.");
      }
    }

    function orderBook(judul) {
      const book = books["filsafat islam"].find(b => b.judul === judul);
      if (book && book.stok > 0) {
        cart.push(book);
        book.stok--;
        addMessage("bot", `‚úÖ Buku <b>${book.judul}</b> telah ditambahkan ke keranjang.<br>Ketik 'keranjang' untuk melihat pesananmu.`);
      } else {
        addMessage("bot", `‚ùå Maaf, buku <b>${judul}</b> sedang habis.`);
      }
    }

    function showCart() {
      if (cart.length === 0) {
        addMessage("bot", "Keranjang kamu masih kosong.");
        return;
      }
      totalHarga = 0;
      let cartList = "üõí <b>Keranjang Pesanan:</b><br>";
      cart.forEach((b, i) => {
        totalHarga += b.harga;
        cartList += `${i + 1}. ${b.judul} - Rp${b.harga}<br>`;
      });
      cartList += `<br><b>Total:</b> Rp${totalHarga}<br>Ketik 'checkout' untuk lanjut pembayaran.`;
      addMessage("bot", cartList);
    }

    function checkout() {
      if (cart.length === 0) {
        addMessage("bot", "Keranjang masih kosong. Tambahkan buku dulu sebelum checkout.");
        return;
      }
      addMessage("bot", "Pilih metode pembayaran:<br>üí≥ Transfer Bank<br>üì± E-Wallet<br>üì¶ COD");
    }

    function confirmPayment(method) {
      if (cart.length === 0) {
        addMessage("bot", "Belum ada pesanan yang bisa dibayar.");
        return;
      }

      let instruksi = "";
      if (method === "Transfer Bank") {
        instruksi = "Silakan transfer ke rekening BSI 123456789 a.n FilsafatBooks Store.";
      } else if (method === "E-Wallet") {
        instruksi = "Silakan kirim pembayaran ke nomor DANA/OVO: 0813-8386-8201.";
      } else if (method === "COD (Bayar di Tempat)") {
        instruksi = "Pesananmu akan dikirim dan dibayar saat diterima.";
      }

      addMessage("bot", `üí∞ Total pembayaran: Rp${totalHarga}<br>Metode: ${method}<br>${instruksi}<br><br>üì¶ Terima kasih sudah berbelanja di <b>FilsafatBooks</b>!`);
      cart.length = 0; // kosongkan keranjang setelah checkout
    }
  </script>

</body>
</html>
